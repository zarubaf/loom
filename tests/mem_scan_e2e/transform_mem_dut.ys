# Test script for mem_scan_insert pass

# Load the SRAM fixture first (so it's known as a black-box)
read_verilog -sv ../fixtures/sram.sv

# Read the DUT with SRAMs
read_verilog -sv ../fixtures/mem_dut.sv

# Process the design
hierarchy -top mem_dut

# Run the memory scan insertion pass
plugin -i ../../build/passes/mem_scan_insert/mem_scan_insert.so
mem_scan_insert -map mem_map.json

# Optimize
opt

# Write output
write_verilog transformed_mem_dut.v

# Print statistics
stat
